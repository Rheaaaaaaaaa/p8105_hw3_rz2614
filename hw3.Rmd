---
title: "Untitled"
author: "Ruihan Zhang"
date: "2022-10-13"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


```{r}
library(tidyverse)
library(dplyr)
library(tidyr)
```

```{r}
accel_data = read_csv(file = "accel_data/accel_data.csv") %>%
  janitor::clean_names()  %>% 
  mutate(
    weekday_weekend = case_when(
      day ==  "Sunday" ~ "weekend",
       day ==  "Saturday" ~ "weekend",
       day ==  "Monday" ~ "weekday",
        day ==  "Tuesday" ~ "weekday",
         day ==  "Wednesday" ~ "weekday",
          day ==  "Thursday" ~ "weekday",
           day ==  "Friday" ~ "weekday"
           
    )) %>%
  select(., week, day_id, day, weekday_weekend, everything())  %>%
  mutate(., total_activity = rowSums(.[5:1443], na.rm = TRUE)) %>% 
  select(., week, day_id, day, weekday_weekend, total_activity, everything())
```
```{r}
accel_table = select(accel_data, day_id, total_activity)
  
```

```{r}
accel_data1 = pivot_longer(accel_data, activity_1:activity_1440, names_to = "activity_types", 
                           values_to = "score")  
  
```

```{r}
plot = ggplot(accel_data1, aes(x = activity_types, y = score, color = day_id)) + geom_point(alpha = .5) +
geom_smooth(se = FALSE) + 
facet_grid(. ~ day_id)
```




